"use strict";function TOTP(t,e=6){this.key=t,this.digits=e}function SITESCANSENSE(t){this.moduleId=t}TOTP.prototype={gen:async function(t=30,e=0){var o=this._base32tohex(this.key),o=BigInt("0x"+o),o=this._bigIntToByteArray(o),e=Math.floor((Date.now()/1e3-e)/t),t=this._int32ToByteArray(e);return"undefined"!=typeof window?(e=await window.crypto.subtle.importKey("raw",o,{name:"HMAC",hash:{name:"SHA-1"}},!1,["sign"]),e=await window.crypto.subtle.sign("HMAC",e,t),this._truncate(new Uint8Array(e))):(e=require("crypto").createHmac("sha1",o).update(new Uint8Array(t)).digest(),this._truncate(e))},_int32ToByteArray:function(t){var e=new ArrayBuffer(8);return new DataView(e).setUint32(4,t,!1),e},_bigIntToByteArray:function(t){var e=new Uint8Array(16);let o=0;for(;0<t;)e[o++]=Number(t%BigInt(256)),t/=BigInt(256);return e.reverse()},_truncate:function(t){var e=15&t[t.length-1];return(((127&t[e])<<24|(255&t[1+e])<<16|(255&t[2+e])<<8|255&t[3+e])%Math.pow(10,this.digits)).toString().padStart(6,"0")},verify:async function(t,e=30){return t===await this.gen(e)},_base32tohex:function(t){for(var e="",o="",n=0;n<t.length;n++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t.charAt(n).toUpperCase()).toString(2).padStart(5,"0");for(n=0;n+4<=e.length;n+=4){var a=e.substr(n,4);o+=parseInt(a,2).toString(16)}return o}},SITESCANSENSE.prototype={payload:{id:encodeURI(window.location.href),uid:function(){var e="sitescansense_visitorid",o={set:function(t){localStorage.setItem(e,t)},get:function(){return localStorage.getItem(e)}};return function(){var t=o.get();function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t||(t=e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e(),o.set(t)),t}}()(),title:document.title,href:window.location.href,origin:window.location.origin,host:window.location.host,hostname:window.location.hostname,pathname:window.location.pathname,search:window.location.search,port:window.location.port,protocol:window.location.protocol,platform:navigator.platform,language:navigator.language,product:navigator.product,appCodeName:navigator.appCodeName,appName:navigator.appName,appVersion:navigator.appVersion,vendor:navigator.vendor,platform:navigator.platform,product:navigator.product,userAgent:navigator.userAgent,language:navigator.language,referer:document.referrer,userAgentData:JSON.stringify(navigator.userAgentData)},endpoint:"localhost"==window.location.hostname||"127.0.0.1"==window.location.hostname?"http://127.0.0.1:5001/sitescansense/asia-northeast3/s3module":"https://s3module-vev5d5srwq-du.a.run.app",getPayload:async function(){var t=await new TOTP("5DX78IeRDPhG8qQj4LFlhy").gen();return this.payload.otp=t,this.payload.moduleId=this.moduleId,JSON.stringify(this.payload)},fetch:async function(t){this.gate||(this.gate=!0,t&&(this.payload.latitude=t.latitude,this.payload.longitude=t.longitude),fetch(this.endpoint+this.payload.search,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:await this.getPayload()}).then(t=>t.json()).then(t=>this.setbpcounter(t)).catch(t=>console.log(t)))},setbpcounter:function(e){var t=document.querySelectorAll(".s3_pv"),o=document.querySelectorAll(".s3_uv"),n=document.querySelectorAll(".s3_total_pv"),a=document.querySelectorAll(".s3_total_uv");void 0!==t&&t.forEach(t=>{t.setAttribute("value",e.page_pv),t.innerHTML=e.page_pv}),void 0!==o&&o.forEach(t=>{t.setAttribute("value",e.page_uv),t.innerHTML=e.page_uv||"unsupported version"}),void 0!==n&&n.forEach(t=>{t.setAttribute("value",e.host_pv),t.innerHTML=e.host_pv}),void 0!==a&&a.forEach(t=>{t.setAttribute("value",e.host_uv),t.innerHTML=e.host_uv||"unsupported version"}),e.message&&console.log("s3 module : "+e.message)}},window.addEventListener("DOMContentLoaded",async function(){var t=document.querySelectorAll('script[src*="s3module"]');new SITESCANSENSE(0<t.length?t[0].getAttribute("moduleId"):null).fetch()});
